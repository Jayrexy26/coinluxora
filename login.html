<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Login - Veloci Global Markets</title>

<meta name="description" content="Secure client login for Veloci Global Markets. Access your account dashboard and manage your profile securely."/>
<meta name="robots" content="index, follow"/>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
  :root{
    --bg:#020617;
    --stroke: rgba(255,255,255,0.12);
    --card: rgba(255,255,255,0.06);
    --text:#e5e7eb;
    --muted:#9ca3af;
    --muted2:#94a3b8;
    --brand1:#3b82f6;
    --brand2:#2563eb;
    --ok:#22c55e;
    --err:#f87171;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    padding:16px;
    overflow-x:hidden;
  }

  body::before{
    content:"";
    position:fixed;
    inset:0;
    background:
      radial-gradient(900px 500px at 15% 12%, rgba(59,130,246,.18), transparent 55%),
      radial-gradient(700px 420px at 85% 18%, rgba(99,102,241,.15), transparent 55%),
      radial-gradient(600px 360px at 45% 92%, rgba(59,130,246,.10), transparent 55%);
    pointer-events:none;
    z-index:0;
  }

  .wrap{ width:100%; max-width:520px; z-index:1; }

  .card{
    width:100%;
    border-radius:18px;
    border:1px solid var(--stroke);
    background: var(--card);
    box-shadow: 0 25px 80px rgba(0,0,0,.50);
    padding:12px 22px 22px;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }

  /* ✅ Logo crop to remove PNG transparent padding */
  .logoSolo{
    display:flex;
    justify-content:center;
    margin:0 auto 2px;
    padding:0;
    line-height:0;
    height:120px;
    overflow:hidden;
  }

  .logoSolo img{
    width:340px;
    max-width:98%;
    height:140px;
    object-fit:cover;
    object-position:center 38%;
    user-select:none;
    -webkit-user-drag:none;

    filter:
      drop-shadow(0 22px 54px rgba(0,0,0,.66))
      drop-shadow(0 0 28px rgba(59,130,246,.28));
    animation: logoPulse 2.8s ease-in-out infinite;
    transform-origin:center;
    display:block;
  }

  @keyframes logoPulse{
    0%, 100%{
      transform: scale(1);
      filter:
        drop-shadow(0 22px 54px rgba(0,0,0,.66))
        drop-shadow(0 0 22px rgba(59,130,246,.24));
      opacity: .98;
    }
    50%{
      transform: scale(1.03);
      filter:
        drop-shadow(0 26px 66px rgba(0,0,0,.72))
        drop-shadow(0 0 42px rgba(59,130,246,.42));
      opacity: 1;
    }
  }

  /* ✅ FIX: prevent "Login" text from clipping */
  h1{
    margin:12px 0 0;
    padding:0 0 2px;
    line-height:1.15;
    font-size:36px;
    text-align:center;
    font-weight:900;
    letter-spacing:-0.8px;
    background: linear-gradient(90deg, #3b82f6, #6366f1);
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
  }

  .sub{
    text-align:center;
    margin-top:8px;
    color: var(--muted);
    font-size:16px;
    margin-bottom:14px;
  }

  /* ✅ Google button + divider */
  .oauth{
    margin-top:10px;
  }

  .oauthBtn{
    width:100%;
    border-radius:12px;
    border:1px solid rgba(255,255,255,0.14);
    background: rgba(255,255,255,0.06);
    color: #eaf0ff;
    font-size:16px;
    font-weight:900;
    padding:13px 14px;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    transition:.15s ease;
    box-shadow: 0 16px 45px rgba(0,0,0,.25);
  }

  .oauthBtn:hover{
    transform: translateY(-1px);
    background: rgba(255,255,255,0.08);
    border-color: rgba(255,255,255,0.22);
  }

  .oauthBtn:active{ transform: translateY(0px); }

  .gIcon{
    width:20px;height:20px;
    border-radius:6px;
    background:#fff;
    display:grid;
    place-items:center;
    overflow:hidden;
    flex:0 0 auto;
  }
  .gIcon svg{ width:16px;height:16px; display:block; }

  .divider{
    display:flex;
    align-items:center;
    gap:12px;
    margin:14px 0 6px;
    color: rgba(229,231,235,.55);
    font-size:13px;
    font-weight:900;
  }
  .divider::before,
  .divider::after{
    content:"";
    height:1px;
    flex:1;
    background: rgba(255,255,255,0.10);
  }

  .field{margin-top:14px;}
  .label{
    font-size:15px;
    font-weight:700;
    color:#d1d5db;
    margin:0 0 8px 2px;
  }

  .input{
    width:100%;
    padding:14px 14px;
    border-radius:12px;
    border:1px solid rgba(255,255,255,0.12);
    background: rgba(2,6,23,0.35);
    color: var(--text);
    font-size:16px;
    outline:none;
    transition:.18s ease;
  }
  .input::placeholder{color:#9ca3af}
  .input:focus{
    border-color: rgba(96,165,250,.60);
    box-shadow: 0 0 0 4px rgba(59,130,246,.18);
  }

  .pwWrap{position:relative;}
  .pwWrap input{padding-right:54px;}
  .togglePw{
    position:absolute;
    right:10px;
    top:50%;
    transform:translateY(-50%);
    width:42px;
    height:42px;
    border-radius:12px;
    border:1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.06);
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:.15s ease;
  }
  .togglePw:hover{transform:translateY(-50%) scale(1.03);}
  .togglePw svg{width:20px;height:20px;opacity:.95}

  .tinyRow{
    margin-top:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    color:var(--muted2);
    font-size:14px;
  }

  .tinyRow a{
    color:#60a5fa;
    font-weight:900;
    text-decoration:none;
  }
  .tinyRow a:hover{text-decoration:underline;}

  .btn{
    width:100%;
    border:none;
    margin-top:22px;
    padding:15px 14px;
    font-size:18px;
    font-weight:900;
    border-radius:12px;
    cursor:pointer;
    color:#fff;
    background: linear-gradient(180deg, var(--brand1), var(--brand2));
    box-shadow: 0 18px 55px rgba(37,99,235,.35);
    transition:.15s ease;
  }

  .btn:hover{transform: translateY(-1px); filter:brightness(1.02);}
  .btn:active{transform: translateY(0px);}

  .msg{
    margin-top:14px;
    text-align:center;
    font-size:14px;
    min-height:18px;
    color: var(--muted);
  }
  .msg .ok{color:var(--ok); font-weight:900}
  .msg .err{color:var(--err); font-weight:900}

  .bottom{
    text-align:center;
    margin-top:18px;
    color: var(--muted);
    font-size:18px;
  }

  .bottom a{
    color:#60a5fa;
    font-weight:900;
    text-decoration:none;
  }
  .bottom a:hover{text-decoration:underline;}

  .trust{
    margin-top:18px;
    padding-top:14px;
    border-top:1px solid rgba(255,255,255,0.10);
    text-align:center;
    color:rgba(229,231,235,.70);
    font-size:12px;
    line-height:1.55;
  }
  .trust .links{
    margin-top:8px;
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    justify-content:center;
  }
  .trust a{
    color:#60a5fa;
    font-weight:900;
    text-decoration:none;
    font-size:12px;
  }
  .trust a:hover{text-decoration:underline;}

  /* ✅ Modal */
  .modalOverlay{
    position:fixed;
    inset:0;
    background: rgba(0,0,0,.55);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:9999;
    padding:18px;
  }
  .modal{
    width:100%;
    max-width:420px;
    border-radius:20px;
    border:1px solid rgba(255,255,255,0.14);
    background: rgba(2,6,23,.72);
    box-shadow: 0 35px 120px rgba(0,0,0,.70);
    padding:22px 18px 18px;
    text-align:center;
    position:relative;
    overflow:hidden;
  }

  .modalWatermark{
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    pointer-events:none;
    z-index:0;
  }
  .modalWatermark img{
    width:280px;
    max-width:90%;
    opacity:0.07;
    filter: drop-shadow(0 40px 90px rgba(0,0,0,.85));
    transform: translateY(-6px);
  }
  .modal::before{
    content:"";
    position:absolute;
    inset:-40px;
    background: radial-gradient(circle at 50% 18%, rgba(96,165,250,.24), transparent 62%);
    filter: blur(16px);
    opacity:.85;
    pointer-events:none;
    z-index:0;
  }

  .modalTitle{
    font-size:22px;
    font-weight:1000;
    letter-spacing:-.2px;
    margin:0;
    color:#eaf0ff;
    position:relative;
    z-index:1;
  }
  .modalSub{
    margin-top:8px;
    color: rgba(234,240,255,.72);
    font-size:14px;
    font-weight:800;
    position:relative;
    z-index:1;
  }
  .dots{
    display:inline-flex;
    gap:4px;
    margin-left:6px;
    transform: translateY(1px);
  }
  .dot{
    width:6px;height:6px;
    border-radius:50%;
    background: rgba(96,165,250,.95);
    opacity:.25;
    animation: blink 1.1s infinite;
  }
  .dot:nth-child(2){animation-delay:.18s}
  .dot:nth-child(3){animation-delay:.36s}
  @keyframes blink{
    0%, 100% { opacity:.25; transform: translateY(0px); }
    45% { opacity:1; transform: translateY(-1px); }
  }

  .modalGlow{
    margin:14px auto 0;
    width:86px;height:86px;
    border-radius:24px;
    background: rgba(34,197,94,.10);
    border:1px solid rgba(34,197,94,.18);
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow: 0 15px 55px rgba(34,197,94,.08);
    position:relative;
    z-index:1;
  }
  .modalGlow svg{width:34px;height:34px; filter: drop-shadow(0 12px 30px rgba(0,0,0,.65));}

  @media(max-width:420px){
    h1{font-size:32px}
    .card{padding:10px 18px 18px}
    .logoSolo{height:112px}
    .logoSolo img{width:300px;height:132px}
    .bottom{font-size:16px}
  }
</style>
</head>

<body>

<div class="wrap">
  <div class="card">

    <div class="logoSolo" aria-hidden="true">
      <img
        src="assets/vgm-logo.png"
        alt="Veloci Global Markets"
        onerror="this.style.display='none';"
      />
    </div>

    <h1>Login</h1>
    <div class="sub">Access your Veloci Global Markets account</div>

    <!-- ✅ Google Sign In -->
    <div class="oauth">
      <button class="oauthBtn" onclick="signInWithGoogle()">
        <span class="gIcon" aria-hidden="true">
          <svg viewBox="0 0 48 48">
            <path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303C33.648 32.659 29.196 36 24 36c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.957 3.043l5.657-5.657C34.046 6.053 29.268 4 24 4 12.955 4 4 12.955 4 24s8.955 20 20 20 20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"/>
            <path fill="#FF3D00" d="M6.306 14.691l6.571 4.819C14.655 16.108 19.021 12 24 12c3.059 0 5.842 1.154 7.957 3.043l5.657-5.657C34.046 6.053 29.268 4 24 4c-7.682 0-14.342 4.337-17.694 10.691z"/>
            <path fill="#4CAF50" d="M24 44c5.166 0 9.86-1.977 13.409-5.197l-6.19-5.238C29.141 35.091 26.715 36 24 36c-5.173 0-9.573-3.305-11.2-7.915l-6.519 5.02C9.566 39.556 16.227 44 24 44z"/>
            <path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303c-.792 2.367-2.398 4.343-4.494 5.565l.003-.002 6.19 5.238C36.564 39.214 44 34 44 24c0-1.341-.138-2.65-.389-3.917z"/>
          </svg>
        </span>
        Continue with Google
      </button>

      <div class="divider">OR</div>
    </div>

    <div class="field">
      <div class="label">Email Address *</div>
      <input id="email" class="input" type="email" placeholder="Enter your email address" autocomplete="email"/>
    </div>

    <div class="field">
      <div class="label">Password *</div>
      <div class="pwWrap">
        <input id="password" class="input" type="password" placeholder="Enter your password" autocomplete="current-password"/>
        <button class="togglePw" type="button" onclick="togglePassword()" aria-label="Show/Hide password">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M2 12s3.6-7 10-7 10 7 10 7-3.6 7-10 7-10-7-10-7Z" stroke="white" stroke-width="1.8"/>
            <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" stroke="white" stroke-width="1.8"/>
          </svg>
        </button>
      </div>

      <div class="tinyRow">
        <span>Secure login</span>
        <a href="#" onclick="forgotPassword(); return false;">Forgot password?</a>
      </div>
    </div>

    <button class="btn" onclick="login()">Login</button>

    <p id="msg" class="msg"></p>

    <div class="bottom">
      Don’t have an account?
      <a href="signup.html">Sign Up</a>
    </div>

    <div class="trust">
      Support: <strong>support@veloci-global-markets.online</strong>
      <div class="links">
        <a href="privacy.html" rel="noopener">Privacy</a>
        <a href="terms.html" rel="noopener">Terms</a>
        <a href="risk.html" rel="noopener">Risk Disclosure</a>
        <a href="contact.html" rel="noopener">Contact</a>
      </div>
      <div style="margin-top:8px; opacity:.85;">
        Risk Warning: Trading and investments involve risk. Past performance does not guarantee future results.
      </div>
    </div>

  </div>
</div>

<!-- ✅ Success Modal -->
<div id="successModal" class="modalOverlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-label="Login successful">

    <div class="modalWatermark" aria-hidden="true">
      <img src="assets/vgm-logo.png" alt="" />
    </div>

    <div class="modalGlow" aria-hidden="true">
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M20 6L9 17l-5-5" stroke="#22c55e" stroke-width="2.6" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>

    <h2 class="modalTitle">Login Successful</h2>
    <div class="modalSub">
      Redirecting
      <span class="dots" aria-hidden="true">
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
      </span>
    </div>

  </div>
</div>

<script>
const SUPABASE_URL="https://xdcscknfomlzwysczegc.supabase.co";
const SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhkY3Nja25mb21send5c2N6ZWdjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MTYzMDMsImV4cCI6MjA4MzI5MjMwM30.E6o2wFFMOpK1DghLUqnxG6Ig09djy4bmDQexprhAiB4";

const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

checkSessionSafely();

async function checkSessionSafely(){
  await new Promise(r => setTimeout(r, 150));
  const { data } = await supabaseClient.auth.getSession();
  const session = data?.session;

  if(session?.user){
    if(!session.user.email_confirmed_at){
      await supabaseClient.auth.signOut();
      setMsg("err", "Please verify your email before logging in.");
      return;
    }
    window.location.href="/session/";
  }
}

function setMsg(type, text){
  const msg=document.getElementById("msg");
  if(type==="ok") msg.innerHTML=`<span class="ok">${text}</span>`;
  else if(type==="err") msg.innerHTML=`<span class="err">${text}</span>`;
  else msg.textContent=text;
}

function togglePassword(){
  const el=document.getElementById("password");
  el.type = (el.type==="password") ? "text" : "password";
}

function showSuccessModal(){
  const modal = document.getElementById("successModal");
  modal.style.display="flex";
  modal.setAttribute("aria-hidden","false");
}

async function signInWithGoogle(){
  setMsg("", "Opening Google sign-in…");

  /* ✅ CHANGED: go directly to /session/ after Google login */
  const redirectTo = window.location.origin + "/session/";

  const { error } = await supabaseClient.auth.signInWithOAuth({
    provider: "google",
    options: { redirectTo }
  });

  if(error){
    setMsg("err", error.message);
    return;
  }
}

async function login(){
  setMsg("", "Logging in…");

  const email=document.getElementById("email").value.trim();
  const password=document.getElementById("password").value;

  if(!email || !password){
    setMsg("err","Fill all fields");
    return;
  }

  const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });

  if(error){
    setMsg("err", error.message);
    return;
  }

  const user = data?.user;
  if(user && !user.email_confirmed_at){
    await supabaseClient.auth.signOut();
    setMsg("err", "Your email is not verified yet. Please check your inbox and verify your account.");
    return;
  }

  setMsg("", "");
  showSuccessModal();
  setTimeout(()=> window.location.href="/session/", 1200);
}

async function forgotPassword(){
  const email=document.getElementById("email").value.trim();

  if(!email){
    setMsg("err","Enter your email first.");
    return;
  }

  setMsg("", "Sending reset email…");

  const { error } = await supabaseClient.auth.resetPasswordForEmail(email, {
    redirectTo: window.location.origin + "/reset-password.html"
  });

  if(error){
    setMsg("err", error.message);
    return;
  }

  setMsg("ok","Reset email sent ✅ Please check your inbox.");
}
</script>

</body>
</html>
